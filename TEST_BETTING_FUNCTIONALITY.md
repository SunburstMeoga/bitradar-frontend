# Trade页面下注功能测试指南

## 🧪 测试环境

- **开发服务器**: http://localhost:5174/
- **API地址**: https://cryptoapi.nickwongon99.top/api/v1
- **测试浏览器**: Chrome/Safari (支持MetaMask)

## 📋 测试清单

### 1. 基础功能测试

#### ✅ 页面加载测试
- [ ] 访问 http://localhost:5174/
- [ ] 确认Trade页面正常显示
- [ ] 确认价格图表正常渲染
- [ ] 确认交易界面正常显示

#### ✅ 钱包连接测试
- [ ] 点击"Connect Wallet"按钮
- [ ] 确认MetaMask弹窗出现
- [ ] 完成钱包连接
- [ ] 确认Header显示绿色边框（已认证状态）

#### ✅ 下注界面测试
- [ ] 输入下注金额（1-1000范围内）
- [ ] 测试滑块调节功能
- [ ] 测试币种选择功能
- [ ] 确认余额显示正确

### 2. 下注功能测试

#### ✅ 正常下注流程
1. **准备工作**
   - [ ] 确保已连接钱包并登录
   - [ ] 确保账户有足够余额
   - [ ] 输入有效的下注金额（1-1000）

2. **执行下注**
   - [ ] 点击"涨"按钮
   - [ ] 观察按钮变为加载状态（旋转动画）
   - [ ] 观察按钮文字变为"下注中..."
   - [ ] 等待API响应

3. **验证结果**
   - [ ] 确认显示成功toast提示
   - [ ] 确认余额自动刷新
   - [ ] 确认交易金额自动重置为0
   - [ ] 确认图表上显示新的下注记录

#### ✅ 买跌测试
- [ ] 重复上述流程，点击"跌"按钮
- [ ] 确认API请求参数为 `orderType: "PUT"`

### 3. 错误场景测试

#### ❌ 未登录状态
- [ ] 断开钱包连接
- [ ] 尝试下注
- [ ] 确认显示"请先连接钱包并登录"错误提示

#### ❌ 余额不足
- [ ] 输入超过余额的金额
- [ ] 尝试下注
- [ ] 确认显示"余额不足"错误提示

#### ❌ 无效金额
- [ ] 输入0或负数
- [ ] 确认按钮被禁用
- [ ] 输入超过1000的金额
- [ ] 确认输入框自动限制

#### ❌ 网络错误
- [ ] 断开网络连接
- [ ] 尝试下注
- [ ] 确认显示网络错误提示

### 4. API集成测试

#### 📡 请求参数验证
检查浏览器开发者工具Network面板：

**正确的请求格式**:
```
POST /api/v1/orders
Content-Type: application/json
Authorization: Bearer <token>

{
  "orderType": "CALL",  // 或 "PUT"
  "amount": 10.5,
  "frontendSubmitTime": 1640995200500
}
```

#### 📡 响应处理验证

**成功响应**:
```json
{
  "success": true,
  "message": "下单成功",
  "data": {
    "orderId": 123,
    "orderType": "CALL",
    "amount": 10.5,
    "entryPrice": 43250.50,
    "ratio": 1.75,
    "status": "PENDING",
    "entryTime": 1640995200500,
    "expiryTime": 1640995260500,
    "timeDifference": 300
  }
}
```

**错误响应**:
```json
{
  "success": false,
  "message": "提交时间超出允许范围，请重新下单"
}
```

### 5. 用户体验测试

#### 🎨 加载状态
- [ ] 下注时按钮显示旋转动画
- [ ] 按钮文字变为"下注中..."
- [ ] 按钮在加载期间被禁用

#### 🎨 反馈提示
- [ ] 成功时显示绿色toast
- [ ] 错误时显示红色toast
- [ ] 提示信息清晰易懂

#### 🎨 界面响应
- [ ] 成功后余额立即更新
- [ ] 交易金额自动重置
- [ ] 滑块位置同步重置

### 6. 边界条件测试

#### 🔢 数值边界
- [ ] 最小金额：1 USDT
- [ ] 最大金额：1000 USDT
- [ ] 小数精度：0.01 USDT

#### ⏱️ 时间相关
- [ ] 快速连续点击（防重复提交）
- [ ] 长时间等待（超时处理）
- [ ] 时间戳精度验证

## 🐛 已知问题

1. **时间同步问题**
   - 前端时间与服务器时间可能存在差异
   - 建议在生产环境中实现时间同步机制

2. **网络重试**
   - 当前版本不支持自动重试
   - 用户需要手动重新下注

## 📊 测试报告模板

```
测试日期: ___________
测试人员: ___________
浏览器版本: ___________
钱包版本: ___________

基础功能: ✅/❌
下注功能: ✅/❌
错误处理: ✅/❌
API集成: ✅/❌
用户体验: ✅/❌

发现问题:
1. ___________
2. ___________
3. ___________

建议改进:
1. ___________
2. ___________
3. ___________
```

## 🚀 自动化测试建议

1. **单元测试**
   - 测试orderService的各个方法
   - 测试输入验证逻辑
   - 测试错误处理机制

2. **集成测试**
   - 测试完整的下注流程
   - 测试API集成
   - 测试状态管理

3. **E2E测试**
   - 使用Cypress或Playwright
   - 模拟真实用户操作
   - 测试钱包集成

---

**测试指南版本**: v1.0.0  
**最后更新**: 2025-01-13
