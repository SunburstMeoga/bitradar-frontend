# BitRadar API 集成测试指南

## 🚀 快速开始

### 1. 启动开发服务器

```bash
yarn dev
```

访问: http://localhost:5174/

### 2. 准备测试环境

- 安装 MetaMask 浏览器扩展
- 确保有测试钱包地址
- 确保网络连接正常

## 🧪 功能测试清单

### ✅ Web3 钱包连接和认证

**测试步骤:**

1. 点击右上角"Connect Wallet"按钮
2. 在 MetaMask 中确认连接
3. 确认自动弹出签名请求
4. 在 MetaMask 中确认签名
5. 验证 Header 按钮变为绿色边框（表示已认证）

**预期结果:**

- 钱包成功连接
- 自动完成 Web3 签名登录
- Header 显示钱包地址和绿色认证状态
- 浏览器控制台无错误信息

### ✅ 用户余额显示

**测试步骤:**

1. 连接钱包后进入 Account 页面
2. 观察余额加载过程
3. 验证余额数据显示

**预期结果:**

- 显示加载动画（骨架屏）
- 成功显示 USDT 余额
- 余额数据来自 API（非 mock 数据）

### ✅ 订单历史分页

**测试步骤:**

1. 进入 History 页面
2. 滚动到页面底部
3. 观察自动加载更多数据
4. 测试网络错误情况（断网后重连）

**预期结果:**

- 初始加载显示加载动画
- 触底自动加载更多数据
- 网络错误时显示错误信息和重试按钮
- 无数据时显示空状态

### ✅ Trade 页面余额显示

**测试步骤:**

1. 连接钱包后进入 Trade 页面
2. 观察余额显示是否来自 API
3. 验证价格数据仍使用原有的 WebSocket mock 数据

**预期结果:**

- 余额数据来自 API（非 mock 数据）
- 价格数据仍使用原有的 WebSocket mock 数据
- 页面功能正常，无错误

### ✅ 错误处理测试

**测试步骤:**

1. 断开网络连接
2. 尝试加载各个页面
3. 重新连接网络
4. 点击重试按钮

**预期结果:**

- 显示友好的错误信息
- 提供重试按钮
- 网络恢复后可以正常重试
- 不会出现白屏或崩溃

## 🔍 API 调用验证

### 检查网络请求

1. 打开浏览器开发者工具
2. 切换到 Network 标签
3. 执行各项操作
4. 验证 API 调用

**应该看到的请求:**

- `POST /api/v1/auth/login` - 登录认证
- `GET /api/v1/users/balance` - 获取余额
- `GET /api/v1/users/orders` - 获取订单历史
- `GET /api/v1/users/profile` - 获取用户资料
- `GET /api/v1/users/stats` - 获取用户统计

### 检查响应数据

验证 API 响应格式符合预期：

```json
{
  "success": true,
  "data": { ... },
  "message": "..."
}
```

## 🐛 常见问题排查

### 1. 钱包连接失败

**可能原因:**

- MetaMask 未安装
- MetaMask 被锁定
- 用户拒绝连接

**解决方案:**

- 确保安装并解锁 MetaMask
- 刷新页面重试
- 检查浏览器控制台错误信息

### 2. API 请求失败

**可能原因:**

- 网络连接问题
- API 服务器不可用
- CORS 配置问题

**解决方案:**

- 检查网络连接
- 验证 API 地址配置
- 查看浏览器控制台网络错误

### 3. 认证失败

**可能原因:**

- 签名被拒绝
- Token 过期
- 钱包地址不匹配

**解决方案:**

- 重新连接钱包
- 清除 localStorage 重新登录
- 检查钱包网络设置

## 📊 性能测试

### 1. 页面加载速度

- 首次加载时间 < 3 秒
- 页面切换响应 < 500ms
- API 响应时间 < 2 秒

### 2. 内存使用

- 长时间使用无内存泄漏
- 图表动画流畅
- 滚动加载性能良好

## 🔒 安全测试

### 1. Token 管理

- Token 安全存储在 localStorage
- 过期自动刷新
- 登出时清除所有 token

### 2. 钱包安全

- 不存储私钥信息
- 签名请求用户确认
- 网络切换提醒

## 📱 移动端测试

### 1. 响应式布局

- 在不同屏幕尺寸下测试
- 触摸操作响应正常
- vw 单位适配正确

### 2. 移动钱包

- 测试移动端 MetaMask
- 测试其他移动钱包
- 深链接功能正常

## 📝 测试报告模板

```
测试日期: ___________
测试人员: ___________
浏览器版本: ___________
MetaMask版本: ___________

功能测试结果:
□ 钱包连接: 通过/失败
□ 用户认证: 通过/失败
□ 余额显示: 通过/失败
□ 订单历史: 通过/失败
□ 价格更新: 通过/失败
□ 错误处理: 通过/失败

发现的问题:
1. ___________
2. ___________
3. ___________

建议改进:
1. ___________
2. ___________
3. ___________
```

---

**注意**: 如果发现任何问题，请记录详细的错误信息和复现步骤，以便开发团队快速定位和修复。
